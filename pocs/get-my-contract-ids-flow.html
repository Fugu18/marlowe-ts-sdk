<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Get my contract ids</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script type="importmap">
      {
        "imports": {
          "@marlowe.io/adapter": "/packages/adapter/dist/bundled/esm/adapter.js",
          "@marlowe.io/adapter/codec": "/packages/adapter/dist/bundled/esm/codec.js",
          "@marlowe.io/adapter/file": "/packages/adapter/dist/bundled/esm/file.js",
          "@marlowe.io/adapter/fp-ts": "/packages/adapter/dist/bundled/esm/fp-ts.js",
          "@marlowe.io/adapter/http": "/packages/adapter/dist/bundled/esm/http.js",
          "@marlowe.io/adapter/time": "/packages/adapter/dist/bundled/esm/time.js",
          "@marlowe.io/language-core-v1": "/packages/language/core/v1/dist/bundled/esm/language-core-v1.js",
          "@marlowe.io/language-core-v1/environment": "/packages/language/core/v1/dist/bundled/esm/environment.js",
          "@marlowe.io/language-core-v1/examples": "/packages/language/core/v1/dist/bundled/esm/examples.js",
          "@marlowe.io/language-core-v1/next": "/packages/language/core/v1/dist/bundled/esm/next.js",
          "@marlowe.io/language-core-v1/state": "/packages/language/core/v1/dist/bundled/esm/state.js",
          "@marlowe.io/language-core-v1/token": "/packages/language/core/v1/dist/bundled/esm/token.js",
          "@marlowe.io/language-core-v1/tokenValue": "/packages/language/core/v1/dist/bundled/esm/tokenValue.js",
          "@marlowe.io/language-core-v1/version": "/packages/language/core/v1/dist/bundled/esm/version.js",
          "@marlowe.io/token-metadata-client": "/packages/token-metadata-client/dist/bundled/esm/token-metadata-client.js",
          "@marlowe.io/wallet": "/packages/wallet/dist/bundled/esm/wallet.js",
          "@marlowe.io/wallet/api": "/packages/wallet/dist/bundled/esm/api.js",
          "@marlowe.io/wallet/browser": "/packages/wallet/dist/bundled/esm/browser.js",
          "@marlowe.io/wallet/nodejs": "/packages/wallet/dist/bundled/esm/nodejs.js",
          "@marlowe.io/runtime-rest-client": "/packages/runtime/client/rest/dist/bundled/esm/runtime-rest-client.js",
          "@marlowe.io/runtime-rest-client/transaction": "/packages/runtime/client/rest/dist/bundled/esm/transaction.js",
          "@marlowe.io/runtime-rest-client/withdrawal": "/packages/runtime/client/rest/dist/bundled/esm/withdrawal.js",
          "@marlowe.io/runtime-core": "/packages/runtime/core/dist/bundled/esm/runtime-core.js",
          "@marlowe.io/runtime-lifecycle": "/packages/runtime/lifecycle/dist/bundled/esm/runtime-lifecycle.js",
          "@marlowe.io/runtime-lifecycle/api": "/packages/runtime/lifecycle/dist/bundled/esm/api.js",
          "@marlowe.io/runtime-lifecycle/browser": "/packages/runtime/lifecycle/dist/bundled/esm/browser.js",
          "@marlowe.io/runtime-lifecycle/generic": "/packages/runtime/lifecycle/dist/bundled/esm/generic.js",
          "lucid-cardano": "https://unpkg.com/lucid-cardano@0.10.7/web/mod.js"
        }
      }
    </script>
    <style>
      .table-label {
        display: flex;
        flex-direction: row;
        justify-content: flex-end;
        align-items: flex-end;
      }
    </style>
  </head>
  <body>
    <table>
      <tr>
        <td class="table-label">Address:</td>
        <td><input type="text" id="address_input" /></td>
      </tr>
      <tr>
        <td class="table-label">Wallet:</td>
        <td id="wallet_input">...</td>
      </tr>
    </table>
  </body>
  <script type="module">
    import { Browser } from "@marlowe.io/runtime-lifecycle";
    import { getAvailableWallets } from "@marlowe.io/wallet";

    const address_input = document.getElementById("address_input");
    const wallet_input = document.getElementById("wallet_input");

    const availableWallets = getAvailableWallets();

    const onWalletChoice = (event) => {
      console.log(event.target.value);
    };

    if (availableWallets.length === 0)
      wallet_input.innerHTML = "No wallet extensions found!";
    else {
      wallet_input.innerHTML = availableWallets
        .map(
          (availableWallet, i) =>
            `<input type="radio"
                id="${availableWallet}_choice"
                name="wallet_choice"
                value="${availableWallet}"
                ${i === 0 ? "checked" : ""}/>
           <label for="${availableWallet}_choice">${availableWallet}</label>`
        )
        .join("<br/>");

      for (const availableWallet of availableWallets) {
        /** @type {HTMLInputElement} */
        const availableWallet_choice = document.getElementById(
          `${availableWallet}_choice`
        );
        availableWallet_choice.onchange = onWalletChoice;
      }
    }

    window.runtimeLifeCycle = await Browser.mkRuntimeLifecycle({
      runtimeURL: "https://marlowe-runtime-preview-web.scdev.aws.iohkdev.io/",
      walletName: "nami", // choose one with getAvailableWallets
    });
  </script>
</html>
